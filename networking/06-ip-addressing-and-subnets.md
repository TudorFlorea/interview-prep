# IP Addressing & Subnets

[â† Back to Index](/networking/00-index.md)

---

## Overview

IP addressing is the foundation of network communication. Understanding IP addresses, subnet masks, and CIDR notation is essential for configuring networks, designing cloud infrastructure, and troubleshooting connectivity issues.

### When This Matters Most
- Designing VPC and cloud network architectures
- Configuring Docker and Kubernetes networking
- Debugging "no route to host" errors
- Understanding network segmentation

---

## IPv4 Addresses

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         IPv4 ADDRESS STRUCTURE                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚   Dotted Decimal:    192.168.1.100                                       â”‚
â”‚                      â””â”€â”¬â”€â”˜â””â”€â”¬â”˜â””â”¬â”˜â””â”¬â”€â”˜                                    â”‚
â”‚   Binary:            11000000.10101000.00000001.01100100                 â”‚
â”‚                                                                          â”‚
â”‚   32 bits total = 4 octets of 8 bits each                               â”‚
â”‚   Range: 0.0.0.0 to 255.255.255.255                                     â”‚
â”‚   Total addresses: 2^32 â‰ˆ 4.3 billion                                   â”‚
â”‚                                                                          â”‚
â”‚   Converting decimal to binary:                                          â”‚
â”‚   192 = 128 + 64 = 11000000                                             â”‚
â”‚   168 = 128 + 32 + 8 = 10101000                                         â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Special IP Addresses

| Address | Purpose |
|---------|---------|
| `0.0.0.0` | "Any" address (listen on all interfaces) |
| `127.0.0.1` | Localhost (loopback) |
| `255.255.255.255` | Broadcast (all hosts on network) |
| `169.254.x.x` | Link-local (DHCP failure fallback) |

---

## Public vs Private IP Addresses

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PUBLIC vs PRIVATE ADDRESSES                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚   PRIVATE (RFC 1918) - Not routable on Internet:                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚ Class A:  10.0.0.0    - 10.255.255.255    (10.0.0.0/8)        â”‚    â”‚
â”‚   â”‚           16 million addresses                                 â”‚    â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚   â”‚ Class B:  172.16.0.0  - 172.31.255.255    (172.16.0.0/12)     â”‚    â”‚
â”‚   â”‚           1 million addresses                                  â”‚    â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚   â”‚ Class C:  192.168.0.0 - 192.168.255.255   (192.168.0.0/16)    â”‚    â”‚
â”‚   â”‚           65,536 addresses                                     â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â”‚   PUBLIC - Routable on Internet:                                         â”‚
â”‚   Everything else (allocated by IANA â†’ RIRs â†’ ISPs)                     â”‚
â”‚                                                                          â”‚
â”‚   NAT (Network Address Translation):                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ Device       â”‚           â”‚  Router  â”‚           â”‚   Internet   â”‚   â”‚
â”‚   â”‚ 192.168.1.10 â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   NAT    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ 203.0.113.5  â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚          â”‚           â”‚  (public IP) â”‚   â”‚
â”‚   Private IP                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â”‚   Multiple private IPs share one public IP                              â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Subnet Masks and CIDR

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         SUBNET MASK                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚   IP Address:     192.168.1.100   = 11000000.10101000.00000001.01100100 â”‚
â”‚   Subnet Mask:    255.255.255.0   = 11111111.11111111.11111111.00000000 â”‚
â”‚                                     â””â”€â”€â”€â”€â”€â”€ Network â”€â”€â”€â”€â”€â”˜â””â”€ Host â”€â”˜     â”‚
â”‚                                                                          â”‚
â”‚   Network ID:     192.168.1.0     (IP AND Mask)                          â”‚
â”‚   Broadcast:      192.168.1.255   (all host bits = 1)                    â”‚
â”‚   Host range:     192.168.1.1 - 192.168.1.254 (254 usable)              â”‚
â”‚                                                                          â”‚
â”‚   CIDR Notation:  192.168.1.0/24  (24 = number of network bits)         â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Common CIDR Blocks

| CIDR | Subnet Mask | Addresses | Usable Hosts | Use Case |
|------|-------------|-----------|--------------|----------|
| /32 | 255.255.255.255 | 1 | 1 | Single host |
| /31 | 255.255.255.254 | 2 | 2 | Point-to-point link |
| /30 | 255.255.255.252 | 4 | 2 | Point-to-point link |
| /28 | 255.255.255.240 | 16 | 14 | Small subnet |
| /24 | 255.255.255.0 | 256 | 254 | Standard LAN |
| /22 | 255.255.252.0 | 1,024 | 1,022 | Medium network |
| /16 | 255.255.0.0 | 65,536 | 65,534 | Large network |
| /8 | 255.0.0.0 | 16.7M | 16.7M | Very large |

**Quick formula**: Usable hosts = 2^(32-CIDR) - 2 (subtract network and broadcast)

---

## Subnetting

### Dividing a Network

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            SUBNETTING: Divide 192.168.1.0/24 into 4 subnets             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚   Original: 192.168.1.0/24 (256 addresses)                              â”‚
â”‚   Need: 4 subnets                                                        â”‚
â”‚   Bits to borrow: 2 (2^2 = 4 subnets)                                   â”‚
â”‚   New prefix: /24 + 2 = /26                                              â”‚
â”‚                                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚ Subnet 1: 192.168.1.0/26                                         â”‚  â”‚
â”‚   â”‚   Network:   192.168.1.0                                         â”‚  â”‚
â”‚   â”‚   Range:     192.168.1.1 - 192.168.1.62                          â”‚  â”‚
â”‚   â”‚   Broadcast: 192.168.1.63                                        â”‚  â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚   â”‚ Subnet 2: 192.168.1.64/26                                        â”‚  â”‚
â”‚   â”‚   Network:   192.168.1.64                                        â”‚  â”‚
â”‚   â”‚   Range:     192.168.1.65 - 192.168.1.126                        â”‚  â”‚
â”‚   â”‚   Broadcast: 192.168.1.127                                       â”‚  â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚   â”‚ Subnet 3: 192.168.1.128/26                                       â”‚  â”‚
â”‚   â”‚   Network:   192.168.1.128                                       â”‚  â”‚
â”‚   â”‚   Range:     192.168.1.129 - 192.168.1.190                       â”‚  â”‚
â”‚   â”‚   Broadcast: 192.168.1.191                                       â”‚  â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚   â”‚ Subnet 4: 192.168.1.192/26                                       â”‚  â”‚
â”‚   â”‚   Network:   192.168.1.192                                       â”‚  â”‚
â”‚   â”‚   Range:     192.168.1.193 - 192.168.1.254                       â”‚  â”‚
â”‚   â”‚   Broadcast: 192.168.1.255                                       â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â”‚   Each subnet: 64 addresses, 62 usable                                  â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Subnetting Cheat Sheet

```
/24 â†’ 256 addresses (block size)
Split into:
  2 subnets â†’ /25 (128 each)
  4 subnets â†’ /26 (64 each)
  8 subnets â†’ /27 (32 each)
  16 subnets â†’ /28 (16 each)

Quick block sizes:
/25 = 128    /26 = 64     /27 = 32     /28 = 16
/29 = 8      /30 = 4      /31 = 2      /32 = 1
```

---

## IPv6 Addresses

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         IPv6 ADDRESS STRUCTURE                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚   Full format:  2001:0db8:85a3:0000:0000:8a2e:0370:7334                 â”‚
â”‚                 â””â”€â”€â”€â”˜â””â”€â”€â”€â”˜â””â”€â”€â”€â”˜â””â”€â”€â”€â”˜â””â”€â”€â”€â”˜â””â”€â”€â”€â”˜â””â”€â”€â”€â”˜â””â”€â”€â”€â”˜                â”‚
â”‚                   8 groups of 4 hex digits (16 bits each)               â”‚
â”‚                                                                          â”‚
â”‚   Shortened:    2001:db8:85a3::8a2e:370:7334                            â”‚
â”‚                 - Leading zeros dropped                                  â”‚
â”‚                 - :: replaces consecutive zero groups (once only)       â”‚
â”‚                                                                          â”‚
â”‚   128 bits total = 2^128 â‰ˆ 340 undecillion addresses                    â”‚
â”‚                                                                          â”‚
â”‚   Prefix notation: 2001:db8::/32                                        â”‚
â”‚                    â””â”€â”€ First 32 bits are network                        â”‚
â”‚                                                                          â”‚
â”‚   Special addresses:                                                     â”‚
â”‚   ::1              Loopback (like 127.0.0.1)                            â”‚
â”‚   ::               Unspecified (like 0.0.0.0)                           â”‚
â”‚   fe80::/10        Link-local (auto-configured)                         â”‚
â”‚   fc00::/7         Unique local (like private IPv4)                     â”‚
â”‚   2000::/3         Global unicast (public addresses)                    â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### IPv4 vs IPv6 Quick Comparison

| Feature | IPv4 | IPv6 |
|---------|------|------|
| Size | 32 bits | 128 bits |
| Format | Decimal (192.168.1.1) | Hex (2001:db8::1) |
| Addresses | ~4.3 billion | ~340 undecillion |
| NAT | Common | Not needed |
| Auto-config | DHCP | SLAAC + DHCPv6 |
| IPsec | Optional | Built-in |

---

## Cloud Networking: VPC Subnets

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AWS VPC SUBNET EXAMPLE                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚   VPC CIDR: 10.0.0.0/16 (65,536 addresses)                              â”‚
â”‚                                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                    Availability Zone A                          â”‚   â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚   â”‚
â”‚   â”‚  â”‚ Public Subnet   â”‚  â”‚ Private Subnet  â”‚                       â”‚   â”‚
â”‚   â”‚  â”‚ 10.0.1.0/24     â”‚  â”‚ 10.0.2.0/24     â”‚                       â”‚   â”‚
â”‚   â”‚  â”‚ (Web servers)   â”‚  â”‚ (App servers)   â”‚                       â”‚   â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚   â”‚
â”‚   â”‚                         â”‚                                        â”‚   â”‚
â”‚   â”‚                         â–¼                                        â”‚   â”‚
â”‚   â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚   â”‚
â”‚   â”‚                  â”‚ Private Subnet  â”‚                            â”‚   â”‚
â”‚   â”‚                  â”‚ 10.0.3.0/24     â”‚                            â”‚   â”‚
â”‚   â”‚                  â”‚ (Databases)     â”‚                            â”‚   â”‚
â”‚   â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                    Availability Zone B                          â”‚   â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚   â”‚
â”‚   â”‚  â”‚ Public Subnet   â”‚  â”‚ Private Subnet  â”‚                       â”‚   â”‚
â”‚   â”‚  â”‚ 10.0.4.0/24     â”‚  â”‚ 10.0.5.0/24     â”‚                       â”‚   â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚   â”‚
â”‚   â”‚                         â”‚                                        â”‚   â”‚
â”‚   â”‚                         â–¼                                        â”‚   â”‚
â”‚   â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚   â”‚
â”‚   â”‚                  â”‚ Private Subnet  â”‚                            â”‚   â”‚
â”‚   â”‚                  â”‚ 10.0.6.0/24     â”‚                            â”‚   â”‚
â”‚   â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â”‚   Reserved addresses per subnet (AWS):                                   â”‚
â”‚   .0 = Network, .1 = VPC router, .2 = DNS, .3 = Future, .255 = Broadcastâ”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Checking IP Configuration

```bash
# Linux
ip addr show
ip route show

# Windows
ipconfig /all
route print

# macOS
ifconfig
netstat -nr

# Check public IP
curl ifconfig.me
curl ipinfo.io

# Docker container networking
docker network inspect bridge
docker exec container_name ip addr
```

---

## Exercises

### Exercise 1: Calculate Subnet Details ğŸŸ¢

**Scenario:** Given the IP 172.16.45.123/20, calculate:
1. Network address
2. Broadcast address
3. Usable host range
4. Number of usable hosts

<details>
<summary>ğŸ’¡ Hints</summary>

- /20 means 20 network bits, 12 host bits
- Convert to binary to find network boundary
- Block size = 2^12 = 4096 addresses

</details>

<details>
<summary>âœ… Solution</summary>

```
IP: 172.16.45.123/20

Step 1: Convert to binary
172.16.45.123 = 10101100.00010000.00101101.01111011
Mask /20      = 11111111.11111111.11110000.00000000

Step 2: Find network address (AND operation)
IP   = 10101100.00010000.00101101.01111011
Mask = 11111111.11111111.11110000.00000000
Net  = 10101100.00010000.00100000.00000000 = 172.16.32.0

Step 3: Find broadcast (set all host bits to 1)
Broadcast = 10101100.00010000.00101111.11111111 = 172.16.47.255

Step 4: Usable range
First usable: 172.16.32.1
Last usable:  172.16.47.254

Step 5: Number of hosts
2^(32-20) - 2 = 2^12 - 2 = 4096 - 2 = 4094 usable hosts
```

**Quick method for /20:**
- Block size = 256 / 16 = 16 in third octet
- 45 / 16 = 2.8, so network starts at 2 Ã— 16 = 32
- Network: 172.16.32.0
- Broadcast: 172.16.32.0 + 16 - 1 = 172.16.47.255

</details>

---

### Exercise 2: Design VPC Subnets ğŸŸ¡

**Scenario:** Design a VPC with CIDR 10.0.0.0/16 for:
- 3 Availability Zones
- Each AZ needs: 1 public subnet (~250 hosts), 1 private app subnet (~500 hosts), 1 private DB subnet (~50 hosts)

Allocate non-overlapping CIDR blocks.

<details>
<summary>ğŸ’¡ Hints</summary>

- ~250 hosts needs at least /24 (254 usable)
- ~500 hosts needs at least /23 (510 usable) or /22
- ~50 hosts needs at least /26 (62 usable)
- Leave room for growth

</details>

<details>
<summary>âœ… Solution</summary>

```
VPC: 10.0.0.0/16 (65,536 addresses)

Strategy: Allocate generously with room for growth

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Availability Zone A (10.0.0.0 - 10.0.15.255)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Public Subnet A:   10.0.0.0/24    (256 addresses, 254 usable)     â”‚
â”‚ Private App A:     10.0.1.0/23    (512 addresses, 510 usable)     â”‚
â”‚ Private DB A:      10.0.3.0/26    (64 addresses, 62 usable)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Availability Zone B (10.0.16.0 - 10.0.31.255)                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Public Subnet B:   10.0.16.0/24   (256 addresses, 254 usable)     â”‚
â”‚ Private App B:     10.0.17.0/23   (512 addresses, 510 usable)     â”‚
â”‚ Private DB B:      10.0.19.0/26   (64 addresses, 62 usable)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Availability Zone C (10.0.32.0 - 10.0.47.255)                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Public Subnet C:   10.0.32.0/24   (256 addresses, 254 usable)     â”‚
â”‚ Private App C:     10.0.33.0/23   (512 addresses, 510 usable)     â”‚
â”‚ Private DB C:      10.0.35.0/26   (64 addresses, 62 usable)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Reserved for future:  10.0.48.0 onwards

Summary:
- Each AZ uses a /20 block (4096 addresses) with room to grow
- Consistent pattern makes management easier
- Can add subnets later within each AZ's range
```

**Terraform example:**
```hcl
locals {
  azs = ["a", "b", "c"]
  public_cidrs  = ["10.0.0.0/24", "10.0.16.0/24", "10.0.32.0/24"]
  private_cidrs = ["10.0.1.0/23", "10.0.17.0/23", "10.0.33.0/23"]
  db_cidrs      = ["10.0.3.0/26", "10.0.19.0/26", "10.0.35.0/26"]
}
```

</details>

---

### Exercise 3: Troubleshoot Connectivity ğŸ”´

**Scenario:** Host A (10.0.1.50/24) cannot ping Host B (10.0.2.100/24). Both are in the same VPC. Diagnose possible causes.

<details>
<summary>ğŸ’¡ Hints</summary>

- Are they on the same subnet?
- What's needed for cross-subnet communication?
- Check routing tables, security groups

</details>

<details>
<summary>âœ… Solution</summary>

**Analysis:**
```
Host A: 10.0.1.50/24
  Network: 10.0.1.0
  Range: 10.0.1.1 - 10.0.1.254

Host B: 10.0.2.100/24
  Network: 10.0.2.0
  Range: 10.0.2.1 - 10.0.2.254

Different subnets! Requires routing.
```

**Checklist:**

```
1. âœ… IP Configuration
   $ ip addr show
   $ ip route show
   
   Check:
   - Correct IP assigned
   - Default gateway configured
   - Route to 10.0.2.0/24 exists

2. âœ… Route Table (VPC level)
   AWS Console â†’ VPC â†’ Route Tables
   
   Check:
   - Route for 10.0.2.0/24 pointing to local
   - Both subnets associated with route table that has local route

3. âœ… Security Groups
   Check Host A's outbound rules:
   - Allow ICMP to 10.0.2.0/24 or 0.0.0.0/0
   
   Check Host B's inbound rules:
   - Allow ICMP from 10.0.1.0/24 or Host A's IP

4. âœ… Network ACLs
   Check subnet-level ACLs:
   - Allow ICMP outbound from subnet A
   - Allow ICMP inbound to subnet B
   - Allow ICMP reply (stateless - need explicit rules)

5. âœ… Host Firewall
   On Host B:
   $ sudo iptables -L -n
   
   Check:
   - ICMP not blocked by local firewall
   - Windows: Check Windows Firewall settings

6. âœ… EC2 Settings (AWS specific)
   - Source/Dest check might block
   - If using NAT instance, disable src/dest check
```

**Debugging commands:**
```bash
# From Host A
ping -c 4 10.0.2.100      # Test connectivity
traceroute 10.0.2.100     # See path
ip route get 10.0.2.100   # Check which route would be used

# Check ARP (if same L2 network)
arp -n

# AWS CLI
aws ec2 describe-route-tables
aws ec2 describe-security-groups
aws ec2 describe-network-acls
```

**Most common causes:**
1. Security group doesn't allow ICMP
2. NACL blocking traffic (stateless, needs return rule)
3. No route between subnets (should be "local" in VPC)

</details>

---

## Key Takeaways

- ğŸ“ **IPv4 = 32 bits**: Dotted decimal, ~4.3 billion addresses, running out
- ğŸ  **Private ranges**: 10.x.x.x, 172.16-31.x.x, 192.168.x.x (not routed publicly)
- â— **CIDR notation**: /24 = 256 addresses, /16 = 65,536 addresses
- ğŸ”¢ **Subnetting**: Borrow bits from host portion to create smaller networks
- ğŸŒ **IPv6 = 128 bits**: Hex notation, essentially unlimited addresses
- â˜ï¸ **Cloud VPCs**: Plan CIDR blocks for growth, separate public/private

---

## Related Topics

- [Routing Basics](/networking/07-routing-basics.md) - How packets find their way
- [Firewalls & Security Groups](/networking/10-firewalls-and-security-groups.md) - Network access control
- [Cloud Networking](/networking/14-cloud-networking.md) - VPC design patterns
